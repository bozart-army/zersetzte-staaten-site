<div class="menu">
  <h3>Archiv</h3>
  <ul>
    <li>
      <a href="{{ '/de/kapitel-index/' | relative_url }}">Kapitel-Index</a>
    </li>
    <li>
      <a href="{{ '/de/quellen/' | relative_url }}">Quellen</a>
    </li>
  </ul>
</div>

<div class="menu">
  <h3>Inhaltsfilter</h3>

  <!-- =========================
       KAPITEL (chronologisch)
       ========================= -->
  <details>
    <summary>Kapitel (chronologisch)</summary>
    <ul>
      {% assign chapters = site.pages
        | where_exp: "p", "p.path contains 'de/kapitel/'"
        | sort: "path" %}
      {% for p in chapters %}
        {% if p.title %}
          <li>
            <a href="{{ p.url | relative_url }}">{{ p.title }}</a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </details>

  <!-- =========================
       REGIONEN (dynamisch)
       ========================= -->
  <details>
    <summary>Regionen</summary>
    <ul>
      {% assign all_regions = "" | split: "" %}
      {% for p in chapters %}
        {% if p.regionen %}
          {% for r in p.regionen %}
            {% unless all_regions contains r %}
              {% assign all_regions = all_regions | push: r %}
            {% endunless %}
          {% endfor %}
        {% endif %}
      {% endfor %}

      {% assign all_regions = all_regions | sort %}
      {% for r in all_regions %}
        <li>
          <a href="{{ '/de/regionen/' | append: r | slugify | append: '/' | relative_url }}">
            {{ r }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </details>

  <!-- =========================
       METHODEN (dynamisch)
       ========================= -->
  <details>
    <summary>Methoden</summary>
    <ul>
      {% assign all_methods = "" | split: "" %}
      {% for p in chapters %}
        {% if p.methoden %}
          {% for m in p.methoden %}
            {% unless all_methods contains m %}
              {% assign all_methods = all_methods | push: m %}
            {% endunless %}
          {% endfor %}
        {% endif %}
      {% endfor %}

      {% assign all_methods = all_methods | sort %}
      {% for m in all_methods %}
        <li>
          <a href="{{ '/de/methoden/' | append: m | slugify | append: '/' | relative_url }}">
            {{ m }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </details>
</div>
